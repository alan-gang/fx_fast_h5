(this.webpackJsonpxystc_fxwap_fast=this.webpackJsonpxystc_fxwap_fast||[]).push([[4],{248:function(e,t,s){"use strict";var a=s(12),n=s(13),i=function(){function e(t,s,n){Object(a.a)(this,e),this.timerItval=0,this.fn=void 0,this.fn=s,this.start(t,s,n)}return Object(n.a)(e,[{key:"start",value:function(e,t){var s=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;this.timerItval=window.setInterval((function(){if(e<=0)return clearInterval(s.timerItval),void t(0,!0);t(e,!1),e--}),a)}},{key:"close",value:function(){clearInterval(this.timerItval)}}]),e}();t.a=i},249:function(e,t,s){},250:function(e,t,s){},251:function(e,t,s){"use strict";var a,n,i=s(12),o=s(13),r=s(19),u=s(18),c=s(20),m=s(0),l=s.n(m),d=s(16),p=s(44),h=s(93),f=(s(249),Object(d.b)("store")(a=Object(d.c)(a=function(e){function t(e){var s;return Object(i.a)(this,t),(s=Object(r.a)(this,Object(u.a)(t).call(this,e))).myScrollRef=void 0,s.scrollToSelectedElement=function(){var e=document.querySelector(".ludan-menu-view .menu-item.selected");s.myScrollRef.current.bscroll&&e&&s.myScrollRef.current.bscroll&&(s.myScrollRef.current.bscroll.x+=1,s.myScrollRef.current.bscroll.scrollToElement(e,150,!0))},s.changeMenu=function(e){s.props.updateMenu(e)},s.myScrollRef=l.a.createRef(),s}return Object(c.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.scrollToSelectedElement()}},{key:"componentWillReceiveProps",value:function(e){this.myScrollRef.current.refresh(),this.scrollToSelectedElement()}},{key:"render",value:function(){var e=this;return l.a.createElement("section",{className:"ludan-menu-view"},l.a.createElement(h.a,{ref:this.myScrollRef},l.a.createElement("nav",{className:"menu"},this.props.tabs&&this.props.tabs.length>0&&this.props.tabs.map((function(t,s){return l.a.createElement("div",{key:s,className:"menu-item ".concat(e.props.selectedMenu===t.name?"selected":""),onClick:function(){return e.changeMenu(t)}},t.title)})))))}}]),t}(m.Component))||a)||a),g=s(96),v=(s(250),Object(d.b)("store")(n=Object(d.c)(n=function(e){function t(e){var s;Object(i.a)(this,t),(s=Object(r.a)(this,Object(u.a)(t).call(this,e))).state=void 0,s.updateMenu=function(e){s.setState({selectedMenu:e.name},s.updateLudanList)},s.updateLudanList=function(){s.setState({ludanList:Object(p.d)(s.props.issueList.slice(0),s.props.gameType,s.state.selectedMenu||"",s.props.maxRows,s.props.maxColumns)||[]})};var a=Object(p.a)(s.props.gameType,s.props.methodMenuName),n=s.props.defaultMenu||(a.length>0?a[0].name:""),o=Object(p.d)(s.props.issueList.slice(0),s.props.gameType,n||"",s.props.maxRows,s.props.maxColumns-1)||[];return s.state={selectedMenu:n,ludanList:o,tabs:a},s}return Object(c.a)(t,e),Object(o.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=Object(p.a)(e.gameType,e.methodMenuName),s=e.defaultMenu||(t.length>0?t[0].name:""),a=Object(p.d)(e.issueList.slice(0),e.gameType,s||"",e.maxRows,e.maxColumns)||[];this.setState({selectedMenu:s,ludanList:a,tabs:t})}},{key:"render",value:function(){return l.a.createElement("section",{className:"ludan-view"},!1!==this.props.isShowLudanMenu&&l.a.createElement(f,{selectedMenu:this.state.selectedMenu,tabs:this.state.tabs,updateMenu:this.updateMenu,methodMenuName:this.props.methodMenuName}),l.a.createElement(g.a,{maxColumns:this.props.maxColumns,maxRows:this.props.maxRows,ludanList:this.state.ludanList,isScroll:this.props.isScroll}))}}]),t}(m.Component))||n)||n);t.a=v},256:function(e,t,s){},257:function(e,t,s){},258:function(e,t,s){},282:function(e,t,s){"use strict";s.r(t);s(137);var a,n,i,o=s(70),r=s(12),u=s(13),c=s(19),m=s(18),l=s(20),d=s(0),p=s.n(d),h=s(16),f=s(248),g=s(66),v=(s(256),Object(h.b)("store")(a=Object(h.c)(a=function(e){function t(e){var s;return Object(r.a)(this,t),(s=Object(c.a)(this,Object(m.a)(t).call(this,e))).state=void 0,s.state={timer:null,remainTime:s.props.remainTime,hours:"00",minutes:"00",seconds:"00"},s}return Object(l.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.initTimer(this.props.remainTime)}},{key:"componentWillReceiveProps",value:function(e){this.setState({remainTime:e.remainTime}),this.initTimer(e.remainTime)}},{key:"initTimer",value:function(e){var t=this;if(!(e<=0)){var s=this.state.timer,a="",n=[];s&&s.close&&s.close(),s=new f.a(Math.floor(e),(function(e){e<=0&&t.props.getNewestIssue(t.props.gameId),a=Object(g.a)(1e3*e),n=a.split(":"),t.setState({hours:n[0],minutes:n[1],seconds:n[2]})})),this.setState({timer:s})}}},{key:"clearTimer",value:function(){this.state.timer&&this.state.timer.close&&this.state.timer.close()}},{key:"componentWillUnmount",value:function(){this.clearTimer()}},{key:"render",value:function(){return p.a.createElement("section",{className:"flex ai-c lobby-game-header-view"},p.a.createElement("div",{className:"flex jc-sb ai-c w100 "},p.a.createElement("div",{className:"txt-r cur-issue-wp"},p.a.createElement("span",{className:"fw-b"},this.props.gameName),p.a.createElement("span",null,this.props.curIssue,"\u671f")),p.a.createElement("div",{className:"time-wp ".concat("00"===this.state.hours&&"00"===this.state.minutes&&parseInt(this.state.seconds,10)<=10?"txt-c-r":"")},p.a.createElement("span",{className:"minute time-item mg-r-3"},this.state.minutes.split("")[0]),p.a.createElement("span",{className:"minute time-item"},this.state.minutes.split("")[1]),p.a.createElement("span",{className:"colon"},":"),p.a.createElement("span",{className:"second time-item mg-r-3"},this.state.seconds.split("")[0]),p.a.createElement("span",{className:"second time-item"},this.state.seconds.split("")[1]))))}}]),t}(d.Component))||a)||a),y=s(251),b=s(23),L=s(28),I=s(44),S=s(95),M=s(123),T=(s(257),{ssc:{methodMenuName:"zhenghe",defaultMenu:"zh_dx",title:"\u603b\u548c\u5927\u5c0f"},"11x5":{methodMenuName:"zhenghe",defaultMenu:"zh_dx",title:"\u603b\u548c\u5927\u5c0f"},pk10:{methodMenuName:"zhenghe",defaultMenu:"zh_dx",title:"\u51a0\u4e9a\u548c\u503c\u5927\u5c0f"},k3:{methodMenuName:"diansu",defaultMenu:"zh_dx",title:"\u603b\u548c\u5927\u5c0f"},hc6:{methodMenuName:"",defaultMenu:"",title:"\u603b\u548c\u5927\u5c0f"}}),j=Object(h.b)("store")(n=Object(h.c)(n=Object(M.a)(n=function(e){function t(e){var s;Object(r.a)(this,t),(s=Object(c.a)(this,Object(m.a)(t).call(this,e))).state=void 0,s.mysocket=void 0,s.init=function(){s.getCurIssue(s.props.gameId),s.getHistoryIssue(s.props.gameId)},s.getCurIssue=function(e){b.a.curIssue({gameid:e}).then((function(e){e.success>0?s.setState({curIssue:e.issue,curTime:e.current,remainTime:Math.floor((e.saleend-e.current)/1e3)||s.state.remainTime+.05}):s.setState({curIssue:""})}))},s.gotoGame=function(){s.props.goto("/game/".concat(s.props.gameId))},s.onIntoGame=function(){if(s.props.store.game.getGameLimitLevelByGameId(s.props.gameId))s.gotoGame();else{var e=s.props.store.game.getLimitListItemById(s.props.gameId);s.setState({isShowLimitSetDialog:!0,limitLevelList:e?e.kqPrizeLimit:[]})}},s.onLimitChoiceCB=function(e){s.props.store.game.updateGamesLimitLevel({gameId:s.props.gameId,level:e}),s.gotoGame()},s.onCloseLimitChoiceHandler=function(){s.setState({isShowLimitSetDialog:!1})};var a=Object(L.e)(e.gameId),n=e.store.game.getLimitListItemById(e.gameId),i=n&&n.bestLudan,o=(Object(I.f)(a,i&&i.codeStyle)||T[a].title)+"\u8def\u5355",u=Object(I.g)(a,i&&i.codeStyle)||T[a].methodMenuName,l=Object(I.e)(a,u,i&&i.codeStyle),d=l&&l.name||T[a].defaultMenu;return s.state={gameType:a,curIssue:"",curTime:0,remainTime:0,issueList:[],maxColumns:19,maxRows:6,isShowLudanMenu:!1,bestLudanConfig:T,bestLudanName:o,isShowLimitSetDialog:!1,limitLevelList:[],methodMenuName:u,defaultMenu:d,bestLudan:i},s}return Object(l.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){this.initDataFromProps()}},{key:"componentWillReceiveProps",value:function(e){this.getCurIssueFromProps(this.props.gameId,e.issueList),this.getBestLudanFromPropsByGameId(this.props.gameId,e.bestLudanList),this.getHistoryIssueFromProps(this.props.gameId,e.recentCodeList)}},{key:"initDataFromProps",value:function(){this.getCurIssueFromProps(this.props.gameId),this.getBestLudanFromPropsByGameId(this.props.gameId),this.getHistoryIssueFromProps(this.props.gameId)}},{key:"initSocket",value:function(){var e=this;this.mysocket=new S.a({url:this.props.store.common.broadcaseWSUrl,name:"lobbyGame"+this.props.gameId,receive:function(t){"openWinCode"===t.type&&t.content&&t.content.length>0&&parseInt(t.content[0].lottId,10)===e.props.gameId&&(e.openWinCode(parseInt(t.content[0].lottId,10),t.content[0]),setTimeout((function(){e.getLimitData(e.props.gameId)}),2e3))},open:function(){if(e.mysocket){var t={action:"noauth"};e.props.store.user.login&&(t={parameter:{userId:e.props.store.user.userId,app:"web"},action:"auth"}),e.mysocket.send(JSON.stringify(t))}}},!0)}},{key:"openWinCode",value:function(e,t){if(e===this.props.gameId){var s=this.state.issueList;s.unshift(t),this.setState({lastIssue:s[0].issue,openNumbers:s[0].code.split(","),issueList:s}),this.getCurIssue(this.props.gameId)}}},{key:"componentDidMount",value:function(){this.initSocket()}},{key:"getCurIssueFromProps",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0;if(t=t.length>0?t:this.props.issueList,s=s||this.props.curServerTime,t&&t.length>0){var a=t.find((function(t){return t.lotteryid===e}));a&&this.setState({curIssue:a.issue,curTime:s,remainTime:Math.floor((a.saleend-s)/1e3)||this.state.remainTime+.05})}}},{key:"getHistoryIssue",value:function(e){var t=this;b.a.historyIssue({gameid:e}).then((function(e){1===e.success&&e.items.length>0&&t.setState({lastIssue:e.items[0].issue,openNumbers:e.items[0].code.split(","),issueList:e.items})}))}},{key:"getHistoryIssueFromProps",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if((t=t.length>0?t:this.props.recentCodeList)&&t.length>0){var s=t.find((function(t){return t[e]&&t[e].length>0}));(s=s&&s[e])&&this.setState({lastIssue:s[0].issue,openNumbers:s[0].code.split(","),issueList:s})}}},{key:"componentWillUnmount",value:function(){this.mysocket&&this.mysocket.removeListen()}},{key:"renderBestLudanTxt",value:function(){var e=this.state.bestLudan;return e?p.a.createElement(p.a.Fragment,null,p.a.createElement("div",null,p.a.createElement("span",{className:"mgr-20"},e.pos,p.a.createElement("span",{className:"c-red"},e.notifyVal),"\u8def\u5355")),p.a.createElement("div",null,p.a.createElement("span",null,[null,"\u957f\u9f99","\u5355\u8df3","\u5355\u8fb9\u8df3","\u4e00\u5385\u4e24\u623f","\u62cd\u62cd\u8fde"][e.notifyType]||"\u8fde\u51fa",p.a.createElement("span",{className:"c-red"},e.contCount),e.unit))):p.a.createElement("div",null)}},{key:"updateBestLudan",value:function(e){var t=(Object(I.f)(this.state.gameType,e&&e.codeStyle)||T[this.state.gameType].title)+"\u8def\u5355",s=Object(I.g)(this.state.gameType,e&&e.codeStyle)||T[this.state.gameType].methodMenuName,a=Object(I.e)(this.state.gameType,s,e&&e.codeStyle),n=a&&a.name||T[this.state.gameType].defaultMenu;this.setState({bestLudanName:t,methodMenuName:s,defaultMenu:n,bestLudan:e}),this.props.store.game.updateLimitListItemBestLudan(e)}},{key:"getLimitData",value:function(e){var t=this;b.a.getBestLudan({lotteryId:e}).then((function(e){1===e.success&&e.bestLudan&&t.updateBestLudan(e.bestLudan)}))}},{key:"getBestLudanFromPropsByGameId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if((t=t.length>0?t:this.props.bestLudanList)&&t.length>0){var s=this.props.bestLudanList.find((function(t){return t.lotteryId===e}));s&&this.updateBestLudan(s)}}},{key:"render",value:function(){return p.a.createElement("section",{className:"lobby-game-view crs-p",onClick:this.gotoGame},p.a.createElement(v,{gameType:this.props.gameType,gameId:this.props.gameId,curIssue:this.state.curIssue,remainTime:this.state.remainTime,gameName:this.props.gameName,getNewestIssue:this.getCurIssue}),p.a.createElement("div",{className:"flex jc-sb best-dudan-name"},this.renderBestLudanTxt()),p.a.createElement("div",{className:"ludan-wp"},p.a.createElement(y.a,{isShowLudanMenu:this.state.isShowLudanMenu,gameId:this.props.gameId,gameType:this.state.gameType,maxColumns:this.state.maxColumns,maxRows:this.state.maxRows,issueList:this.state.issueList.slice(0).reverse(),methodMenuName:this.state.methodMenuName,defaultMenu:this.state.defaultMenu,isScroll:!1})))}}]),t}(d.Component))||n)||n)||n,k=s(39),E=(s(258),5),O=1,N=1,C=Object(h.b)("store")(i=Object(h.c)(i=function(e){function t(e){var s;Object(r.a)(this,t),(s=Object(c.a)(this,Object(m.a)(t).call(this,e))).DEFAULT_GAME_TYPE="hot",s.state=void 0,s.reflv=void 0,s.init=function(){s.checkFrom();var e=s.getGameIds(s.state.curGames);N=Math.ceil(e.length/E),s.setState({gameIds:e},s.loadMore)},s.goto=function(e){s.props.history.push(e)},s.onMenuChanged=function(e){s.setState({curGames:e===s.DEFAULT_GAME_TYPE?Object(L.c)():Object(L.g)(e)})},s.loadMore=function(){s.loadData(),O++},s.loadData=function(){if(!(O>N)){s.setState({isLoading:!0});var e=s.state.gameIds.slice((O-1)*E,O*E).join(","),t=s.state.curGames.slice(0,O*E);s.getIssuesByGameIds(e),s.getBatchBestLudanByGameIds(e),s.getBatchRecentCodesByGameIds(e).then((function(){s.setState({isLoading:!1,gamesDataSource:s.state.gamesDataSource.cloneWithRows(t)})}))}},s.renderItem=function(e){return p.a.createElement(j,{key:e.id,gameType:s.state.curGameType,gameId:e.id,gameName:e.name,goto:s.goto,issueList:s.state.issueList,bestLudanList:s.state.bestLudanList,recentCodeList:s.state.recentCodeList,curServerTime:s.state.curServerTime})},s.onEndReached=function(){s.loadMore()};var a=s.filterAvailableGames(Object(L.c)());return s.state={curGameType:s.DEFAULT_GAME_TYPE,curGames:a,gamesDataSource:new o.a.DataSource({rowHasChanged:function(e,t){return!0}}),issueList:[],bestLudanList:[],recentCodeList:[],curServerTime:0,isLoading:!1,gameIds:[]},s}return Object(l.a)(t,e),Object(u.a)(t,[{key:"componentWillMount",value:function(){var e=this;O=1,N=1,this.state.curGames.length<=0?this.props.store.game.getAvailableGames((function(t){e.setState({curGames:e.filterAvailableGames(Object(L.c)())},e.init)})):this.init()}},{key:"filterAvailableGames",value:function(e){var t=this;if(this.props.store.game.availableGames.length<=0)return[];var s=[];return e.forEach((function(e){28!==e.id&&t.props.store.game.hasAvailableGame(e.id)&&s.push(e)})),s}},{key:"checkFrom",value:function(){var e=Object(k.a)("gameid");e&&this.state.curGames.length>0&&(this.state.curGames.find((function(t){return t.id===parseInt(e,10)}))&&this.goto("/game/".concat(e)))}},{key:"getGameIds",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return e.map((function(e){return e.id}))||[]}},{key:"getIssuesByGameIds",value:function(e){var t=this;b.a.getIssuesByGameIds({gameid:e}).then((function(e){e.success>0&&t.updateIssues(e.items,e.current)}))}},{key:"getBatchBestLudanByGameIds",value:function(e){var t=this;b.a.getBatchBestLudanByGameIds({lotteryId:e}).then((function(e){e.success>0&&t.updateBestLudans(e.bestLudan)}))}},{key:"getBatchRecentCodesByGameIds",value:function(e){var t=this;return b.a.getBatchRecentCodesByGameIds({gameid:e}).then((function(e){e.success>0&&t.updateRecentCodes(e.data)}))}},{key:"updateIssues",value:function(e,t){var s=this.state.issueList,a=-1;e.forEach((function(e){-1!==(a=s.findIndex((function(t){return t.lotteryid===e.lotteryid})))?s.splice(a,1,e):s.push(e)})),this.setState({issueList:s,curServerTime:t})}},{key:"updateBestLudans",value:function(e){var t=this.state.bestLudanList,s=-1;e.forEach((function(e){-1!==(s=t.findIndex((function(t){return t.lotteryId===e.lotteryId})))?t.splice(s,1,e):t.push(e)})),this.setState({bestLudanList:t})}},{key:"updateRecentCodes",value:function(e){var t=this.state.recentCodeList,s=-1;e.forEach((function(e){-1!==(s=t.findIndex((function(t){return t[e.lotteryid]&&t[e.lotteryid].length>0})))?t.splice(s,1,e):t.push(e)})),this.setState({recentCodeList:t})}},{key:"render",value:function(){var e=this;return p.a.createElement("article",{className:"lobby-view"},p.a.createElement("section",{className:"flex lobby-game-ls"},p.a.createElement(o.a,{ref:function(t){return e.reflv=t},dataSource:this.state.gamesDataSource,renderFooter:function(){return p.a.createElement("div",{style:{padding:20,textAlign:"center"}},e.state.isLoading?"\u52a0\u8f7d\u4e2d...":O>=N?"\u5df2\u663e\u793a\u6240\u6709":"\u4e0a\u62c9\u52a0\u8f7d\u66f4\u591a")},renderRow:this.renderItem,pageSize:E,onEndReached:this.onEndReached,onEndReachedThreshold:1600})))}}]),t}(d.Component))||i)||i;t.default=C}}]);
//# sourceMappingURL=4.eb035461.chunk.js.map